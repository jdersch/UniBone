	.title ma_du - MSCP test driver

	; MSCP DMA is generated by reading block 0

duvect = 154		; vector of UDA controller
dubase = 772150		; base addr of UDA controller
dulabl = 'U		; label char


	; --- ISRs, increment Interrupt FLags
duiflg:	.word	1	; Interrupt flags

dubuff:	.blkw	1000+1	; data buffer: 512 words

duecnt:	.word	1	; event counter

duisr:
	inc	duiflg	; set ISR flag
	rti

	; --- Initialize device after RESET
duinit:
	clr	duecnt
	return

	; --- Restart new DMA transmission
dugo:
	mov	#dubase,r1		; r1 = controller base address

	; TODO: read block 0 like boot loader


	inc	duecnt			; register as event
	return

